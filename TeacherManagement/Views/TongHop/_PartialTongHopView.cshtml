@model IEnumerable<TeacherManagement.DTOs.GiaoVienTongHopTaiDTO>
@{
    Layout = null;

    double tongTaiYeuCau = 0;
    double tongTaiThucTe = 0;

    double DTTT = ViewBag.DTTT;
    double DTYC = ViewBag.DTYC;
    double NCTT = ViewBag.NCKHTT;
    double NCYC = ViewBag.NCKHYC;
    double PTNC = ViewBag.PTNC;
    double PTDT = ViewBag.PTDT;
}

<div class="table-responsive">
    <table class="table table-bordered" width="100%" cellspacing="0">
        <thead style="font-weight: 500; text-align: center;">
            <tr>
                <th class="tg-0pky" rowspan="2">STT</th>
                <th class="tg-0pky" rowspan="2">Họ và Tên</th>
                <th class="tg-0pky" colspan="3">Tải đào tạo</th>
                <th class="tg-0pky" colspan="3">Tải nghiên cứu khoa học</th>
                <th class="tg-0pky" colspan="3">Tổng tải</th>
            </tr>
            <tr>
                <td class="tg-0pky">Thực tải</td>
                <td class="tg-0pky">Tải yêu cầu</td>
                <td class="tg-0pky">%Đào tạo</td>
                <td class="tg-0pky">Thực tải</td>
                <td class="tg-0pky">Tải yêu cầu</td>
                <td class="tg-0pky">%NCKH</td>
                <td class="tg-0pky">Thực tải</td>
                <td class="tg-0pky">Tải yêu cầu</td>
                <td class="tg-0pky">%Tổng</td>
            </tr>
        </thead>

        <tbody>
            @if (Model == null || Model.Count() == 0)
            {
                <tr>
                    <td class="tg-0lax" colspan="11" style="text-align:center;">không có dữ liệu</td>
                </tr>
            }
            else
            {
                int i = 1;
                foreach (var item in Model)
                {
                    <tr>
                        <td class="tg-0lax">@i</td>
                        <td class="tg-0lax">@item.GiaoVien.TenGV</td>
                        <td class="tg-0lax" style="text-align:center;">@(item.TaiDaoTao == null ? "0.0" : string.Format("{0:00.0}", item.TaiDaoTao.SoTietThucTe))</td>
                        <td class="tg-0lax" style="text-align:center;">@(item.TaiDaoTao == null ? "0.0" : string.Format("{0:00.0}", item.TaiDaoTao.SoTietYeuCau))</td>
                        <td class="tg-0lax" style="text-align:center;">@(item.TaiDaoTao == null ? "0.0%" : string.Format("{0:00.0}", item.TaiDaoTao.TinhPhanTram()) + "%")</td>
                        <td class="tg-0lax" style="text-align:center;">@(item.TaiNCKH == null ? "0.0" : string.Format("{0:00.0}", item.TaiNCKH.SoTaiNCKHThucTe))</td>
                        <td class="tg-0lax" style="text-align:center;">@(item.TaiNCKH == null ? "0.0" : string.Format("{0:00.0}", item.TaiNCKH.SoTaiYeuCau))</td>
                        <td class="tg-0lax" style="text-align:center;">@(item.TaiNCKH == null ? "0.0%" : string.Format("{0:00.0}", item.TaiNCKH.TinhPhanTram()) + "%")</td>
                        @{
                            if (item.TaiDaoTao == null && item.TaiNCKH != null)
                            {
                                tongTaiThucTe = item.TaiNCKH.SoTaiNCKHThucTe;
                                tongTaiYeuCau = item.TaiNCKH.SoTaiYeuCau;
                            }
                            if (item.TaiDaoTao != null && item.TaiNCKH == null)
                            {
                                tongTaiThucTe = item.TaiDaoTao.SoTietThucTe;
                                tongTaiYeuCau = item.TaiDaoTao.SoTietYeuCau;
                            }
                            if (item.TaiDaoTao == null && item.TaiNCKH == null)
                            {
                                tongTaiThucTe = 0;
                                tongTaiYeuCau = 0;
                            }
                            if (item.TaiDaoTao != null && item.TaiNCKH != null)
                            {
                                tongTaiThucTe = item.TaiDaoTao.SoTietThucTe + item.TaiNCKH.SoTaiNCKHThucTe;
                                tongTaiYeuCau = item.TaiDaoTao.SoTietYeuCau + item.TaiNCKH.SoTaiYeuCau;
                            }

                        }
                        <td class="tg-0lax" style="text-align:center;">@(string.Format("{0:00.0}", tongTaiThucTe))</td>
                        <td class="tg-0lax" style="text-align:center;">@(string.Format("{0:00.0}", tongTaiYeuCau))</td>
                        <td class="tg-0lax" style="text-align:center;">@(string.Format("{0:00.0}", (tongTaiThucTe * 100) / tongTaiYeuCau) + "%")</td>
                    </tr>
                    i++;
                }
                <tr style="text-align:center;">
                    <td colspan="2">Tổng</td>
                    <td>@string.Format("{0:00.0}", DTTT)</td>
                    <td>@string.Format("{0:00.0}", DTYC)</td>
                    <td>@string.Format("{0:00.0}", PTDT)%</td>
                    <td>@string.Format("{0:00.0}", NCTT)</td>
                    <td>@string.Format("{0:00.0}", NCYC)</td>
                    <td>@string.Format("{0:00.0}", PTNC)%</td>
                    <td>@string.Format("{0:00.0}", DTTT + NCTT)</td>
                    <td>@string.Format("{0:00.0}", DTYC + NCYC)</td>
                    <td>@string.Format("{0:00.0}", PTDT + PTNC)%</td>
                </tr>
            }

        </tbody>
    </table>
</div>